# Force HTTPS is enabled on the server already
# RewriteEngine On
# RewriteCond %{HTTPS} off
# RewriteCond %{REQUEST_URI} !^/\.well-known/acme-challenge/.+$
# RewriteCond %{REQUEST_URI} !^/\.well-known/cpanel-dcv/[0-9a-zA-Z_-]+$
# RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/(?:\ Ballot169)?
# RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
# RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]

# Additional security to lock down files and folders
<FilesMatch "package\.json|package-lock\.json|bower\.json|composer\.json|composer\.lock|\.md">
  Require all denied
</FilesMatch>

# Prevent clickjacking and MIME-Sniffing
Header ADD X-FRAME-OPTIONS DENY
Header set X-Content-Type-Options nosniff

# add Content-Security-Policy headers
# generated with https://www.validbot.com/tools/csp-wizard.php
Header add Content-Security-Policy "base-uri 'self'; default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
